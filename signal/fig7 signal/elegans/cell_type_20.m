clc;
clear;
n = 100;
DATA=cell(n, 7)
a = 10;
signal_pathway=cell(n, 7);

for i = 1:n
    % 二细胞期
    cell_types2_0 = [1, 2];
    X2 = [0,440.409790625000;440.409790625000,0];
    [max_cell_types_2, cell_types2_0, signal_pathway] = signal_transduction(cell_types2_0, X2, a, i, 1, signal_pathway);
    
    % 三细胞期
    cell_types3_0 = [cell_types2_0(1), cell_types2_0(1), cell_types2_0(2)];
    X3 = [0,180.164221875000,219.528150000000;180.164221875000,0,441.086537500000;219.528150000000,441.086537500000,0];
    [max_cell_types_3, cell_types3_0, signal_pathway] = signal_transduction(cell_types3_0, X3, a, i, 2, signal_pathway);
    
    % 四细胞期
    cell_types4_0 = [cell_types3_0, max(cell_types3_0) + 1];
    X4 = [0, 350.615186767647, 276.770501102941, 0;
        350.615186767647, 0, 282.025218014706, 281.348473532353;
        276.770501102941, 282.025218014706, 0, 136.007800735294;
        0, 281.348473532353, 136.007800735294, 0];
    [max_cell_types_4, cell_types4_0, signal_pathway] = signal_transduction(cell_types4_0, X4, a, i, 3, signal_pathway);
    
    
    % 六细胞期
    cell_types6_0 = [cell_types4_0(1), cell_types4_0(1), cell_types4_0(2), cell_types4_0(2), cell_types4_0(3), cell_types4_0(4)];
    X6 = [0, 76.3244300000000, 94.7524765625000, 0, 191.315166255000, 0;
        76.3244300000000, 0, 288.992145630000, 107.496985005000, 111.625123125000, 0;
        94.7524765625000, 288.992145630000, 0, 70.3663106250000, 212.625365005000, 79.6903368800000;
        0, 107.496985005000, 70.3663106250000, 0, 94.1135825050000, 206.701054375000;
        191.315166255000, 111.625123125000, 212.625365005000, 94.1135825050000, 0, 184.036705625000;
        0, 0, 79.6903368800000, 206.701054375000, 184.036705625000, 0];
    [max_cell_types_6, cell_types6_0, signal_pathway] = signal_transduction(cell_types6_0, X6, a, i, 4, signal_pathway);
    
    % 七细胞期
    cell_types7_0 = [cell_types6_0(1), cell_types6_0(2), cell_types6_0(3), cell_types6_0(4), cell_types6_0(5), cell_types6_0(5), cell_types6_0(6)];
    X7 = [0,114.471272916667,120.968529170000,0,212.118789166667,0,0;
        114.471272916667,0,283.274910000000,155.766358333333,99.3359566666667,0,0;
        120.968529170000,283.274910000000,0,117.016512916667,131.574023753333,83.8911608333333,88.4328629166667;
        0,155.766358333333,117.016512916667,0,69.8276743750000,78.7968129166667,195.523670000000;
        212.118789166667,99.3359566666667,131.574023753333,69.8276743750000,0,50.3597608333333,0;
        0,0,83.8911608333333,78.7968129166667,50.3597608333333,0,169.252150416667;
        0,0,88.4328629166667,195.523670000000,0,169.252150416667,0];
    [max_cell_types_7, cell_types7_0, signal_pathway] = signal_transduction(cell_types7_0, X7, a, i, 5, signal_pathway);
    
    % 八细胞期
    cell_types8_0 = [cell_types7_0, max(cell_types7_0) + 1];
    X8 = [0,102.939481620588,143.721795588235,0,0,0,0,0;
        102.939481620588,0,161.856758455882,177.059165808824,90.6112113970588,0,0,0;
        143.721795588235,161.856758455882,0,0,233.843716176471,90.5023136029412,77.1797492647059,0;
        0,177.059165808824,0,0,0,66.4270441176471,229.127977573529,0;
        0,90.6112113970588,233.843716176471,0,0,130.472162500000,0,0;
        0,0,90.5023136029412,66.4270441176471,130.472162500000,0,98.4309459558823,145.820929044118;
        0,0,77.1797492647059,229.127977573529,0,98.4309459558823,0,110.003719488235;
        0,0,0,0,0,145.820929044118,110.003719488235,0]
    [max_cell_types_8, cell_types8_0, signal_pathway] = signal_transduction(cell_types8_0, X8, a, i, 6, signal_pathway);
    
    % 12细胞期
    cell_types12_0 = [cell_types8_0(1), cell_types8_0(1), cell_types8_0(2), cell_types8_0(2), cell_types8_0(3), cell_types8_0(3), cell_types8_0(4), cell_types8_0(4), cell_types8_0(5), cell_types8_0(6), cell_types8_0(7), cell_types8_0(8)];
    X12 = [0,67.9243007352941,94.1112562500000,0,99.5024250000000,0,0,0,0,0,0,0;
        67.9243007352941,0,0,0,112.357301470588,26.4055711764706,0,0,169.545903676471,0,0,0;
        94.1112562500000,0,0,81.8101694852941,77.1576334558824,0,70.1200259929412,0,91.8813683823529,0,0,0;
        0,0,81.8101694852941,0,120.286112867647,0,151.828742279412,0,0,0,74.8028095588235,0;
        99.5024250000000,112.357301470588,77.1576334558824,120.286112867647,0,57.0354594117647,0,0,74.5839231647059,0,17.8638265808824,0;
        0,26.4055711764706,0,0,57.0354594117647,0,0,0,148.844217647059,128.376821694118,60.8229024632353,0;
        0,0,70.1200259929412,151.828742279412,0,0,0,102.163540073529,0,0,88.5977794117647,0;
        0,0,0,0,0,0,102.163540073529,0,54.5655900735294,107.897687132353,164.727828308824,26.7667494488235;
        0,169.545903676471,91.8813683823529,0,74.5839231647059,148.844217647059,0,54.5655900735294,0,141.557971691177,0,0;
        0,0,0,0,0,128.376821694118,0,107.897687132353,141.557971691177,0,52.4835520958824,97.1747382352941;
        0,0,0,74.8028095588235,17.8638265808824,60.8229024632353,88.5977794117647,164.727828308824,0,52.4835520958824,0,125.715340073529;
        0,0,0,0,0,0,0,26.7667494488235,0,97.1747382352941,125.715340073529,0];
    [max_cell_types_12, cell_types12_0, signal_pathway] = signal_transduction(cell_types12_0, X12, a, i, 7, signal_pathway);
    
    DATA{i,1} = max_cell_types_2;
    DATA{i,2} = max_cell_types_3;
    DATA{i,3} = max_cell_types_4;
    DATA{i,4} = max_cell_types_6;
    DATA{i,5} = max_cell_types_7;
    DATA{i,6} = max_cell_types_8;
    DATA{i,7} = max_cell_types_12;
end

idx10=2;
idx20=1;
cell_types1=[1,7,7,1,4,4,4,4,2,5,3,6];
idx1_set=[];idx2_set=[];cell_types_set=[];
for n=1:size(signal_pathway,1)
    idx1_set=[idx1_set;signal_pathway{n,7}.idx1];
    idx2_set=[idx2_set;signal_pathway{n,7}.idx2];
    cell_types_set=[cell_types_set;signal_pathway{n,7}.cell_types];
end
Row1=find(idx1_set==idx10);
Row2=find(idx2_set==idx20);
Rowa=intersect(Row1,Row2);
nn=all(cell_types_set==cell_types1,2);
Rowb=find(nn);
Row=intersect(Rowa,Rowb);
real_number=length(Row);

B=[];
B=cell2mat(DATA);
[R, C] = size(B);
for i = 1:R
    row = B(i, :);
    b=max(row);
    nonZero = row(row ~= 0);
    num = C - length(nonZero);
    newRow = [nonZero, b*ones(1, num)];
    B(i, :) = newRow;
end
